Current Path: /home/NIO/mace
[0;32mCMD> [0mbash tools/cmake/cmake-generate-proto-py-host.sh
CMAKE_VERSION: 3.22.1
CROSSTOOL_ROOT:
CMAKE_TOOLCHAIN_FILE:
CMAKE_INSTALL_PREFIX: /home/NIO/mace/build/cmake-build/host/install
MACE_ENABLE_CPU            = ON
MACE_ENABLE_NEON           = OFF
MACE_ENABLE_QUANTIZE       = OFF
MACE_ENABLE_OPENCL         = OFF
MACE_ENABLE_CUDA           = OFF
MACE_ENABLE_HEXAGON_DSP    = OFF
MACE_ENABLE_HEXAGON_HTA    = OFF
MACE_ENABLE_MTK_APU        = OFF
MACE_ENABLE_BFLOAT16       = OFF
MACE_ENABLE_FP16           = OFF
MACE_ENABLE_QNN            =
MACE_ENABLE_TESTS          = ON
MACE_ENABLE_BENCHMARKS     = ON
MACE_ENABLE_OPT_SIZE       = ON
MACE_ENABLE_OBFUSCATE      = ON
MACE_ENABLE_CCACHE         = ON
MACE_ENABLE_CODE_MODE      = OFF
MACE_ENABLE_RPCMEM         = OFF
-- Configuring done
-- Generating done
-- Build files have been written to: /home/NIO/mace/build/cmake-build/host
[ 66%] Built target protoc_bin
[100%] Built target mace_proto_py
[ 66%] Built target protoc_bin
[100%] Built target micro_mem_proto_py

[0;32mCMD> [0madb devices
tools/python/run_model.py:76: Run on devices: ['f8c1b50e']
tools/python/run_model.py:90: Run model combine_qkv
[92m{'platform': <Platform.ONNX: 2>, 'model_file_path': '/home/NIO/llm/transformer/onnxModel/CombineQKV_1_144_128.onnx', 'model_sha256_checksum': 'b52b598693a8d2b7a70798990274db04509b036503bce9d661bcad9ae5e42833', 'subgraphs': {'default_graph': {'platform': <Platform.ONNX: 2>, 'model_file_path': '/home/NIO/llm/transformer/onnxModel/CombineQKV_1_144_128.onnx', 'model_sha256_checksum': 'b52b598693a8d2b7a70798990274db04509b036503bce9d661bcad9ae5e42833', 'runtime': <DeviceType.HEXAGON: 3>, 'quantize_range_file': '/home/NIO/mace/workspace/attention/range_dir/combine_qkv_overall_log', 'quantize': 1, 'limit_opencl_kernel_time': 0, 'nnlib_graph_mode': 0, 'obfuscate': 0, 'input_data_formats': [<DataFormat.NONE: 0>], 'input_ranges': [[-1.0, 1.0]], 'output_data_formats': [<DataFormat.NONE: 0>], 'input_tensors': ['input'], 'output_tensors': ['output'], 'validation_inputs_data': ['/home/NIO/llm/transformer/onnxModel/tensor_data/input_1_144_128.raw'], 'data_type': 1, 'input_shapes': [[1, 144, 128]], 'input_data_types': [1], 'output_shapes': [[1, 144, 128]], 'output_data_types': [1], 'backend': ['pytorch']}}, 'runtime': <DeviceType.HEXAGON: 3>, 'quantize_range_file': '/home/NIO/mace/workspace/attention/range_dir/combine_qkv_overall_log', 'quantize': 1, 'limit_opencl_kernel_time': 0, 'nnlib_graph_mode': 0, 'obfuscate': 0, 'input_data_formats': [], 'input_ranges': [], 'output_data_formats': [], 'input_tensors': ['input'], 'output_tensors': ['output'], 'validation_inputs_data': ['/home/NIO/llm/transformer/onnxModel/tensor_data/input_1_144_128.raw'], 'data_type': 1}[0m
[0;32mCMD> [0madb -s f8c1b50e shell mkdir -p /data/local/tmp/mace_tmp/combine_qkv/interior

[0;32mCMD> [0madb -s f8c1b50e shell mkdir -p /data/local/tmp/mace_tmp/combine_qkv

[0;32mCMD> [0madb -s f8c1b50e push build/combine_qkv/model/combine_qkv.pb /data/local/tmp/mace_tmp/combine_qkv
[0;32mCMD> [0madb -s f8c1b50e shell mkdir -p /data/local/tmp/mace_tmp/combine_qkv

[0;32mCMD> [0madb -s f8c1b50e push build/combine_qkv/model/combine_qkv.data /data/local/tmp/mace_tmp/combine_qkv
[0;32mCMD> [0madb -s f8c1b50e shell mkdir -p /data/local/tmp/mace_tmp/combine_qkv/validate_in

[0;32mCMD> [0madb -s f8c1b50e push /tmp/tmpd8qwyjhk/* /data/local/tmp/mace_tmp/combine_qkv/validate_in
[0;32mCMD> [0madb -s f8c1b50e shell mkdir -p /data/local/tmp/mace_tmp/combine_qkv/validate_out

Install target from build/cmake-build/arm64-v8a/install/bin/mace_run to /data/local/tmp/mace_tmp/combine_qkv
[0;32mCMD> [0madb -s f8c1b50e shell mkdir -p /data/local/tmp/mace_tmp/combine_qkv

[0;32mCMD> [0madb -s f8c1b50e push build/cmake-build/arm64-v8a/install/bin/mace_run /data/local/tmp/mace_tmp/combine_qkv
[0;32mCMD> [0madb -s f8c1b50e push third_party/nnlib/arm64-v8a/libhexagon_controller.so /data/local/tmp/mace_tmp/combine_qkv
[0;32mCMD> [0madb -s f8c1b50e push third_party/nnlib/v66/libhexagon_nn_skel.so /data/local/tmp/mace_tmp/combine_qkv
[0;32mCMD> [0madb -s f8c1b50e push build/cmake-build/arm64-v8a/install/lib/libc++_shared.so /data/local/tmp/mace_tmp/combine_qkv
[0;32mCMD> [0madb -s f8c1b50e shell chmod 777 /data/local/tmp/mace_tmp/combine_qkv/mace_run

['', 'MACE_INTERNAL_STORAGE_PATH=/data/local/tmp/mace_tmp/combine_qkv/interior', 'MACE_CPP_MIN_VLOG_LEVEL=0', 'LD_LIBRARY_PATH=/data/local/tmp/mace_tmp/combine_qkv', 'ADSP_LIBRARY_PATH=/data/local/tmp/mace_tmp/combine_qkv', '/data/local/tmp/mace_tmp/combine_qkv/mace_run', "--model_name='combine_qkv'", "--model_file='/data/local/tmp/mace_tmp/combine_qkv/combine_qkv.pb'", "--model_data_file='/data/local/tmp/mace_tmp/combine_qkv/combine_qkv.data'", "--input_node='input'", "--input_shape='1,144,128'", "--output_node='output'", "--output_shape='1,144,128'", "--input_data_format='NONE'", "--output_data_format='NONE'", "--input_data_type='1'", "--output_data_type='1'", '--input_file=/data/local/tmp/mace_tmp/combine_qkv/validate_in/combine_qkv', '--output_file=/data/local/tmp/mace_tmp/combine_qkv/validate_out/combine_qkv']
[0;32mCMD> [0madb -s f8c1b50e shell " MACE_INTERNAL_STORAGE_PATH=/data/local/tmp/mace_tmp/combine_qkv/interior MACE_CPP_MIN_VLOG_LEVEL=0 LD_LIBRARY_PATH=/data/local/tmp/mace_tmp/combine_qkv ADSP_LIBRARY_PATH=/data/local/tmp/mace_tmp/combine_qkv /data/local/tmp/mace_tmp/combine_qkv/mace_run --model_name='combine_qkv' --model_file='/data/local/tmp/mace_tmp/combine_qkv/combine_qkv.pb' --model_data_file='/data/local/tmp/mace_tmp/combine_qkv/combine_qkv.data' --input_node='input' --input_shape='1,144,128' --output_node='output' --output_shape='1,144,128' --input_data_format='NONE' --output_data_format='NONE' --input_data_type='1' --output_data_type='1' --input_file=/data/local/tmp/mace_tmp/combine_qkv/validate_in/combine_qkv --output_file=/data/local/tmp/mace_tmp/combine_qkv/validate_out/combine_qkv"
I /home/NIO/mace/mace/tools/mace_run.cc:705] hello
I /home/NIO/mace/mace/tools/mace_run.cc:725] model name: combine_qkv
I /home/NIO/mace/mace/tools/mace_run.cc:726] mace version: v1.1.1-68-g23d5d03
I /home/NIO/mace/mace/tools/mace_run.cc:727] input node: input
I /home/NIO/mace/mace/tools/mace_run.cc:728] input shape: 1,144,128
I /home/NIO/mace/mace/tools/mace_run.cc:729] input data_type: 1
I /home/NIO/mace/mace/tools/mace_run.cc:730] input data_format: NONE
I /home/NIO/mace/mace/tools/mace_run.cc:733] input data_type: 1
I /home/NIO/mace/mace/tools/mace_run.cc:734] output data_format: NONE
I /home/NIO/mace/mace/tools/mace_run.cc:735] input_file: /data/local/tmp/mace_tmp/combine_qkv/validate_in/combine_qkv
I /home/NIO/mace/mace/tools/mace_run.cc:736] output_file: /data/local/tmp/mace_tmp/combine_qkv/validate_out/combine_qkv
I /home/NIO/mace/mace/tools/mace_run.cc:737] input dir:
I /home/NIO/mace/mace/tools/mace_run.cc:738] output dir: output
I /home/NIO/mace/mace/tools/mace_run.cc:739] model_data_file: /data/local/tmp/mace_tmp/combine_qkv/combine_qkv.data
I /home/NIO/mace/mace/tools/mace_run.cc:740] model_file: /data/local/tmp/mace_tmp/combine_qkv/combine_qkv.pb
I /home/NIO/mace/mace/tools/mace_run.cc:741] accelerator_cache_policy: 0
I /home/NIO/mace/mace/tools/mace_run.cc:742] accelerator_binary_file:
I /home/NIO/mace/mace/tools/mace_run.cc:743] accelerator_storage_file:
I /home/NIO/mace/mace/tools/mace_run.cc:744] apu_boost_hint: 100
I /home/NIO/mace/mace/tools/mace_run.cc:745] apu_preference_hint: 1
I /home/NIO/mace/mace/tools/mace_run.cc:746] round: 1
I /home/NIO/mace/mace/tools/mace_run.cc:747] restart_round: 1
I /home/NIO/mace/mace/tools/mace_run.cc:748] gpu_perf_hint: 3
I /home/NIO/mace/mace/tools/mace_run.cc:749] gpu_priority_hint: 3
I /home/NIO/mace/mace/tools/mace_run.cc:750] num_threads: -1
I /home/NIO/mace/mace/tools/mace_run.cc:751] cpu_affinity_policy: 1
W /home/NIO/mace/mace/utils/thread_pool.cc:108] CPU maybe isolated, don't set CPU affinity
I /home/NIO/mace/mace/core/memory/rpcmem/rpcmem.cc:32] Rpcmem is supported. type: 0
I /home/NIO/mace/mace/rpcmems/rpcmem_factory.cc:53] Rpcmem is supported. type: 0
I /home/NIO/mace/mace/libmace/engines/serial_engine.cc:33] Creating SerialEngine, MACE version: v1.1.1-68-g23d5d03
W /home/NIO/mace/mace/utils/thread_pool.cc:108] CPU maybe isolated, don't set CPU affinity
I /home/NIO/mace/mace/tools/mace_run.cc:820] restart round 0
W /home/NIO/mace/mace/utils/thread_pool.cc:108] CPU maybe isolated, don't set CPU affinity
I /home/NIO/mace/mace/core/memory/rpcmem/rpcmem.cc:32] Rpcmem is supported. type: 0
I /home/NIO/mace/mace/rpcmems/rpcmem_factory.cc:53] Rpcmem is supported. type: 0
I /home/NIO/mace/mace/libmace/engines/serial_engine.cc:33] Creating SerialEngine, MACE version: v1.1.1-68-g23d5d03
W /home/NIO/mace/mace/utils/thread_pool.cc:108] CPU maybe isolated, don't set CPU affinity
I /home/NIO/mace/mace/runtimes/hexagon/dsp/hexagon_dsp_runtime.cc:41] Hexagon DSP version: 0x21a01
I /home/NIO/mace/mace/runtimes/hexagon/dsp/hexagon_dsp_wrapper.cc:161] Hexagon config
I /home/NIO/mace/mace/runtimes/hexagon/dsp/hexagon_dsp_wrapper.cc:167] Hexagon init
I /home/NIO/mace/mace/runtimes/hexagon/dsp/hexagon_dsp_wrapper.cc:470] Reset perf info
I /home/NIO/mace/mace/runtimes/hexagon/dsp/hexagon_dsp_wrapper.cc:388] Set debug level: 0
I /home/NIO/mace/mace/runtimes/hexagon/dsp/hexagon_dsp_wrapper.cc:181] Hexagon setup graph
I /home/NIO/mace/mace/tools/mace_run.cc:463] Create Mace Engine latency: 45.519 ms
I /home/NIO/mace/mace/tools/mace_run.cc:470] Total init latency: 131.497 ms
I /home/NIO/mace/mace/tools/mace_run.cc:316] runtimes: [CPU, DSP]
I /home/NIO/mace/mace/tools/mace_run.cc:487] intput_file: /data/local/tmp/mace_tmp/combine_qkv/validate_in/combine_qkv_input
I /home/NIO/mace/mace/tools/mace_run.cc:555] Warm up run
W /home/NIO/mace/mace/core/tensor.cc:182] Tensor::Resize, allocate private mem, name: output, new shape: [1, 1, 144, 128]
I /home/NIO/mace/mace/tools/mace_run.cc:597] 1st warm up run latency: 1.729 ms
I /home/NIO/mace/mace/tools/mace_run.cc:605] Run model
I /home/NIO/mace/mace/tools/mace_run.cc:673] Average latency: 1.434 ms
I /home/NIO/mace/mace/tools/mace_run.cc:686] Write output file /data/local/tmp/mace_tmp/combine_qkv/validate_out/combine_qkv_output with size 18432 done.
========================================================
capability(CPU)        init      warmup     run_avg
========================================================
time         442.494     131.497       1.729       1.434
I /home/NIO/mace/mace/runtimes/hexagon/dsp/hexagon_dsp_wrapper.cc:354] Hexagon teardown graph
I /home/NIO/mace/mace/runtimes/hexagon/dsp/hexagon_dsp_wrapper.cc:174] Hexagon finalize

['', 'MACE_INTERNAL_STORAGE_PATH=/data/local/tmp/mace_tmp/combine_qkv/interior', 'MACE_CPP_MIN_VLOG_LEVEL=0', 'LD_LIBRARY_PATH=/data/local/tmp/mace_tmp/combine_qkv', 'ADSP_LIBRARY_PATH=/data/local/tmp/mace_tmp/combine_qkv', '/data/local/tmp/mace_tmp/combine_qkv/mace_run', "--model_name='combine_qkv'", "--model_file='/data/local/tmp/mace_tmp/combine_qkv/combine_qkv.pb'", "--model_data_file='/data/local/tmp/mace_tmp/combine_qkv/combine_qkv.data'", "--input_node='input'", "--input_shape='1,144,128'", "--output_node='output'", "--output_shape='1,144,128'", "--input_data_format='NONE'", "--output_data_format='NONE'", "--input_data_type='1'", "--output_data_type='1'", '--input_file=/data/local/tmp/mace_tmp/combine_qkv/validate_in/combine_qkv', '--output_file=/data/local/tmp/mace_tmp/combine_qkv/validate_out/combine_qkv']
[0;32mCMD> [0madb -s f8c1b50e push /tmp/tmp48y4va0f/cmd.sh /data/local/tmp/mace_tmp/combine_qkv
/tmp/tmp48y4va0f/cmd.sh: 1 file pushed, 0 skipped. 0.1 MB/s (768 bytes in 0.008s)

b52b598693a8d2b7a70798990274db04509b036503bce9d661bcad9ae5e42833
[0;32mCMD> [0madb -s f8c1b50e pull /data/local/tmp/mace_tmp/combine_qkv/validate_out /tmp/tmpd8qwyjhk/validate_out
validate on onnxruntime.
==========Run model===========
